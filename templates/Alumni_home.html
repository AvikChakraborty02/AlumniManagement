<!doctype html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  {% load static %}
  <link rel="icon" type="image/png" href="{% static 'logo3.png' %}">
  <title>Alumni | Home</title>
  
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
  
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.1/dist/umd/popper.min.js" integrity="sha384-9/reFTGAW83EW2RDu2S0VKaIzap3H66lZH81PoYlFhbGU+6BZp6G7niu735Sk7lN" crossorigin="anonymous"></script>
  <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js" integrity="sha384-B4gt1jrGC7Jh4AgTPSdUtOBvfO8shuf57BaghqFfPlYxofvL8/KUEfYiJOMMV+rV" crossorigin="anonymous"></script>
  
  <!-- Google Font -->
  <link href="https://fonts.googleapis.com/css?family=Open+Sans:300,400|Nunito:600,700" rel="stylesheet"> 
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.3.0/font/bootstrap-icons.css">

  <style>
    body {
      font-family: 'Nunito',sans-serif;
      ;
    }

    p {
      font-size: 16px;
    }
    i{
      font-family: 'Times New Roman', Times, serif;
    }
    nav {
      background-color: rgb(52, 8, 5);
      position: -webkit-sticky;
      position: sticky;
      z-index: 9999;
      top: 0;
    }

    .nav-item:hover {
      position: relative;
      transform: scale(1.1);
      transition: 0.6s;
    }

    .offcanvas{
            z-index: 10000;
            position: fixed;
        }
    .offcanvas-header{
            margin-top: 10%;
    }

    .element {
      display: flex;
      justify-content: start;
      margin-top: 0%;
      align-items: center;
    }

    .items {
      display: flex;
      justify-content: center;
      align-items: start;
      margin-top: 1%;
      padding: 2%;
    }
    
    .card-body {
      background-color: #F5F5DC;
    }
    .submit-button{
      margin-top: 2%;
    }
    #button{
            background-color:rgb(52, 8, 5) ;
            color: white;
            display: inline-flex;
            align-items: center;
            font-size: 16px;
        }
    .load-more-button{
      display: flex;
      justify-content: center;
      align-items: center;
      margin-top: 2%;
      margin-bottom: 2%;
    }
    .post-header {
      display: flex;
      align-items: center;
    }

    #createpost{
      font-size: 16px;
      margin-bottom: 1%;
    }
    .postimage{
      display: flex;
      justify-content: center;
    }
    .modal-dialog{
      top: 10%;
      margin: auto;
    }
    .not-visible {
        display: none;
    }
  </style>
</head>

<body>

  <!--nav bar start -->
  <nav class="navbar navbar-expand-lg navbar-dark">
    <div class="container-fluid">
      <a class="navbar-brand" href="#">
        <img src="{% static 'logo3.png' %}" alt="" width="50" height="50" class="d-inline-block align-text-center">
        <strong style="text-wrap: balance;">RCC Institute of Information Technology</strong></a>
      <div class="changepassword">
        <a href="/alumni_change_password_otp"><button type="button" class="btn btn-outline-light" id="button">Change Password <i class="bi bi-key" style="margin-left:4px ; margin-right: 0;"></i></button></a>
        &nbsp;
        <a href="/logout/"><button type="button" class="btn btn-outline-light" id="button">Log Out <i class="bi bi-box-arrow-left" style="margin-left:4px ; margin-right: 0;"></i></button></a>
      </div>
    </div>
  </nav>

  <!-- Dashboard Button-->
  <div class="element">
    <a data-bs-toggle="offcanvas" style="color: black; font-size: 35px; margin-left: 1%; margin-top: 0.7%;" href="#offcanvasExample"
      role="button" aria-controls="offcanvasExample">
      <i class="bi bi-list"></i></a>
    <h3 style="margin-left: 1%; margin-top: 1.5%;"> Home</h3>
  </div>
  <div class="offcanvas offcanvas-start" tabindex="-1" id="offcanvasExample" aria-labelledby="offcanvasExampleLabel">
    <div class="offcanvas-header">
      <h3 class="offcanvas-title" id="offcanvasExampleLabel" style="color: rgb(52, 8, 5);">Dashboard</h3>
      <button type="button" class="btn-close" data-bs-dismiss="offcanvas" aria-label="Close"></button>
    </div>
    <div class="offcanvas-body">
      <div>
        <a href="/alumni_home" style="color: rgb(52, 8, 5);text-decoration: none;">
          <div class="items"><i class="bi bi-house-fill"></i>
            <h5 style="margin-left: 2%; margin-top: 1%;">Home</h5>
          </div>
        </a>
        <hr style="margin: auto;">
        <a href="/my_profile" style="color: rgb(52, 8, 5);text-decoration: none;">
          <div class="items"><i class="bi bi-file-earmark-post"></i>
            <h5 style="margin-left: 2%; margin-top: 1%;">My Profile</h5>
          </div>
        </a>
        <hr style="margin: auto;">
        <a href="/batchmates" style="color: rgb(52, 8, 5);text-decoration: none;">
          <div class="items"><i class="bi bi-people-fill"></i>
            <h5 style="margin-left: 2%; margin-top: 1%;">Batchmates</h5>
          </div>
        </a>
        <hr style="margin: auto;">
        <a href="/alumni_search_alumni" style="color: rgb(52, 8, 5);text-decoration: none;">
          <div class="items"><i class="bi bi-search"></i>
            <h5 style="margin-left: 2%; margin-top: 1%;">Search Alumni</h5>
          </div>
        </a>
      </div>
    </div>
  </div>

  <!--grid-->
  <div class="container">
    <div class="row">
      <div class="col-sm-4 col-md-4 mt-3">
        <h2>Upcoming Events</h2>
        <hr>
        <div class="card mt-3">
          <div class="card-body">
            {% for event in event_obj %}
            <a href="{{ event.event.url }}" target="_blank">{{event.posted_on}} - {{event.description}}</a>{% if event.is_new == "yes" %}<img src="{%static 'new.gif'%}" height="25" width="35">{% endif %}<br>
            {% endfor %}
          </div>
        </div>
        <!--Donate Now-->
        <div class="card mt-3">
          <div class="card-body">
              <p class="donate-quote" style="font-style: italic;">What you once received as a student, you now return as a legacy!</p>
              <a href="/donate/"><button class="btn" type="button" id="button">Donate Now</button></a>
              <a href="#"><button class="btn" type="button" id="button">My Donations</button></a>
          </div>
        </div>
      </div>
      
      <div class="col mt-3">
        <!-- Card Starts -->
        <h2 >Posts</h2>
        <hr>
        <!--Create Post-->
        <div class="row">
          <div class="col-sm-4 mt-3 col-md-6 col-lg-6">
            <div class="card">
              <div class="card-body">
                <p>What's on your mind?</p>&nbsp;
                  <a href="/create_post/"><button class="btn" type="button" id="button">Create Post</button></a>
              </div>
            </div>
          </div>
          <div class="col-sm-4 mt-3 col-md-6 col-lg-6">
            <div class="card">
              <div class="card-body">
               <h3>Batchmates: {{ batchmates_count }}</h3>
               <h3>Total Alumni: {{ alumni_count }}</h3>
              </div>
            </div>
          </div>
        </div>
         <!-- Card Starts -->
          <div class="content" id="content">
            {% for post in post_obj %}
            <div class="post card mt-3">
              <div class="card-body">
                <div class="post-header">
                  <img src="{{post.profile_picture.url}}" alt="Profile Image" height="30" width="30" style="border-radius: 100px; object-fit: cover; object-position: center;">
                  <div class="post-info">
                    <span class="post-name">&nbsp;&nbsp;<b>{{ post.name }}</b></span>
                    <span class="post-date"><i class="bi bi-dot"></i>{{post.posted_on}}</span>
                  </div>
                </div>
                <div class="edit d-flex justify-content-center">
                  <h4 style="margin: auto;display: inline-block;">{{post.title}}</h4>
                </div>
                <hr>
                <p>{{post.description}}</p>
                <p style="display: inline-block;">Link - </p>
                <span>
                  {% if post.link1 %}
                  <a href="{{post.link1}}" style="margin-left: 1%;">{{post.link1}}</a>
                  {% endif %}
    
                  {% if post.link2 %}
                  <a href="{{post.link2}}" style="margin-left: 1%;">,{{post.link2}}</a>
                  {% endif %}
    
                  {% if post.link3 %}
                  <a href="{{post.link3}}" style="margin-left: 1%;">,{{post.link3}}</a>
                  {% endif %}
                </span>       
              </div>
            </div>
            {% endfor %}
        </div>

         <!--Spinner-->
         <div class="d-flex justify-content-center mt-2">
          <div class="spinner-border not-visible" style="color: rgb(52, 8, 5);" role="status" id="spinner">
          </div>
         </div>        
        
        <!--Load More Button-->
        <div class="load-more-button">
          <button type="submit" class="btn" id="load-more-button" style="background-color:rgb(52, 8, 5) ; color: white; display: inline-flex; align-items: center; font-size: 16px;">Load More...</button>
        </div>

        <div class="alert alert-danger mt-2 not-visible" role="alert" id='alert' style="text-align: center;">
          No more post to load!!
        </div>
        {{totalpost_obj|json_script:"json-total"}}
      </div> 
    </div>
  </div>
  

  <!-- Footer -->
  <footer class="footer mt-auto py-3 bg-light">
    <div class="container-fl text-center">
      <span class="text">&copy; 2024 by RCC Institute of Information Technology | All Rights Reserved.</span>
    </div>
  </footer>


  <!-- BootStrap JS -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"
    integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz"
    crossorigin="anonymous"></script>
  
    
    <script>
        // var _current_item = $('.single_content').length
        // console.log(_current_item);
        const loadBtn = document.getElementById('load-more-button');
        const spinner = document.getElementById('spinner');
        const total = JSON.parse(document.getElementById('json-total').textContent);
        const alert = document.getElementById('alert');

        function loadmorePost() {
            var _current_item = $('.post').length
            const content_container = document.getElementById("content");
            $.ajax({
                url: '{% url "load" %}',
                type: 'GET',
                data: {
                    'offset': _current_item
                },
                beforeSend: function () {
                    loadBtn.classList.add('not-visible');
                    spinner.classList.remove('not-visible');
                },
                success: function (response) {
                    const data = response.post_obj
                    spinner.classList.add('not-visible')
                    data.map(post => {
                        console.log(post.title);
                        content_container.innerHTML += `<div class="post card mt-3">
           <div class="card-body">
             <div class="post-header">
               <img src="${post.profile_picture}" alt="Profile Image" height="30" width="30" style="border-radius: 100px; object-fit: cover; object-position: center;">
               <div class="post-info">
                 <span class="post-name">&nbsp;&nbsp;<b>${post.name}</b></span>
                 <span class="post-date"><i class="bi bi-dot"></i>${post.posted_on}</span>
               </div>
             </div>
             <div class="edit d-flex justify-content-center">
               <h4 style="margin: auto;display: inline-block;">${post.title}</h4>
             </div>
             <hr>
             <p>${post.description}</p>
             <p style="display: inline-block;">Link - </p>
             <span>
               {% if post.link1 %}
               <a href="${post.link1}" style="margin-left: 1%;">${post.link1}</a>
               {% endif %}
 
               {% if post.link2 %}
               <a href="${post.link2}" style="margin-left: 1%;">,${post.link2}</a>
               {% endif %}
 
               {% if post.link3 %}
               <a href="${post.link3}" style="margin-left: 1%;">,${post.link3}</a>
               {% endif %}
             </span>       
           </div>
         </div>`
                    })
                    if (_current_item == total) {
                        alert.classList.remove('not-visible');
                    } else {
                        loadBtn.classList.remove('not-visible');
                    }
                },
                error: function (err) {
                    console.log(err);
                },
            });
        }
        loadBtn.addEventListener('click', () => {
            loadmorePost()
        });

        //formatting date
      

      document.addEventListener('DOMContentLoaded', function() {
    // Select all elements with the class 'post-date'
    const dateElements = document.querySelectorAll('.post-date');

    // Iterate over each element and format the date
    dateElements.forEach(element => {
      // Create a Date object from the input string
      const dateString=element.textContent;
      const date = new Date(dateString);

      // Extract year, month, and day components
      const year = date.getFullYear();
      const month = String(date.getMonth() + 1).padStart(2, '0'); // Add leading zero if needed
      const day = String(date.getDate()).padStart(2, '0'); // Add leading zero if needed   


      // Format the date in the desired format
      const formattedDate = `${year}-${month}-${day}`;
      console.log(formattedDate);
      element.innerHTML=`<i class="bi bi-dot"></i>${formattedDate}`;
      });
    });
    </script>

</body>

</html>
